<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="Interactive simulator for the Ctrl-Mac protocol with configurable parameters and real-time visualization."
        />
        <title>Ctrl-Mac Simulator</title>
        <link rel="stylesheet" href="/src/css/common.css" />
        <link rel="stylesheet" href="/src/css/style.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        />
        <link rel="icon" href="/logo.ico" type="image/x-icon" />
    </head>
    <body>
        <load src="/src/pages/navbar.html" home="active" />

        <h2>Simulation interface</h2>
        <div id="container">
            <div id="form-column">
                <form id="simulation-form">
                    <label>
                        Sensor Count:
                        <input
                            type="number"
                            name="sensor_count"
                            value="6"
                            title="Enter the number of sensors to simulate"
                        />
                    </label>
                    <label>
                        Max Cycles:
                        <input
                            type="number"
                            name="max_cycles"
                            value="7"
                            title="Number of cycles to simulate"
                        />
                    </label>
                    <label>
                        Seed:
                        <input
                            type="string"
                            name="seed"
                            placeholder="Leave empty for random seed"
                            value="226"
                            title="Seed for the simulation, define to get deterministic behaviour"
                        />
                    </label>
                    <label>
                        Request Slots:
                        <input
                            type="number"
                            name="request_slots"
                            value="6"
                            title="Number of requests slots in the rrm message"
                        />
                    </label>

                    <details>
                        <summary>Advanced Settings</summary>
                        <div id="simulation-form-advanced-section">
                            <label>
                                Data Channels:
                                <input
                                    type="number"
                                    name="data_channels"
                                    value="3"
                                    title="Number of data channels available for sending data transmissions"
                                />
                            </label>
                            <label>
                                Data Slots per Channel:
                                <input
                                    type="number"
                                    name="data_slots_per_channel"
                                    value="2"
                                    title="Number of time based data slots for each channel"
                                />
                            </label>
                            <label>
                                RRM Period:
                                <input
                                    type="number"
                                    name="rrm_period"
                                    value="0.5"
                                    title="Time in seconds, specifying the time between each rrm message"
                                />
                            </label>
                            <label>
                                Sensors Measurement Chance:
                                <input
                                    type="string"
                                    value="1.0"
                                    name="sensors_measurement_chance"
                                    title="Chance of each sensor sensing data to send when in idle state"
                                />
                            </label>
                        </div>
                    </details>
                    <button type="submit" id="submit-button">
                        Generate Simulation
                    </button>
                    <button type="button" id="reset-button">Reset</button>
                </form>
                <div id="error-box"></div>
                <div id="seed-box">No simulation loaded!</div>
                <div id="loading-text" style="display: none">
                    Computing the simulation just for you...
                    <i class="fa fa-refresh"></i>
                </div>

                <div id="simulation-result">
                    <div id="result"></div>

                    <div id="simulation-control">
                        <button type="button" , id="prev-button" disabled>
                            <i class="fas fa-backward"></i>
                        </button>
                        <button
                            type="button"
                            id="play-pause-button"
                            data-state="paused"
                            disabled
                        >
                            <i class="fas fa-play"></i>
                        </button>
                        <button type="button" , id="next-button" disabled>
                            <i class="fas fa-forward"></i>
                        </button>
                        <button type="button" , id="restart-button" disabled>
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div id="canvas-column"></div>
        </div>

        <div id="data-display">
            <h2>FTR and Measurement Latency Analysis</h2>
            <div id="plotly-graph"></div>

            <h2>Summary statistics</h2>
            <table id="summary-statistics-table">
                <tr>
                    <td>Stable FTR value</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Cycles to reach FTR equilibrium</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Measurement Latency 1st percentile</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Measurement Latency 25th percentile</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Measurement Latency 50th percentile</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Measurement Latency 75th percentile</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Measurement Latency 99th percentile</td>
                    <td></td>
                </tr>
            </table>
        </div>

        <script type="module" src="/main.js"></script>
    </body>
</html>
